?clusterplots
?plot
plot
View(pca_data)
View(combined_control_data)
clusterfeatures(pca_kmeans, featurestart=9, featureend=33)
clusterfeatures(pca_kmeans, featurestart=9, featureend=35)
source("~/Documents/microglia-morphology-analysis/analysis0.R")
clusterfeatures(pca_kmeans, featurestart=9, featureend=35)
View(pca_kmeans)
#Ameboid only
# Extracting the "Ameboid" cluster
ramified_cluster <- filter(pca_kmeans, Cluster == "2")
#Ameboid only
# Extracting the "Ameboid" cluster
ramified_cluster <- filter(pca_kmeans, Cluster == "2")
View(combined_control_data)
View(normalized_combined_control_data)
Summary(normalized_combined_control_data)
plot <- clusterplots(pca_kmeans, "PC1", "PC2")
View(plot)
#5
cp <- clusterpercentage(pca_kmeans, "Cluster", Sex)
#Ameboid only
# Extracting the "Ameboid" cluster
ramified_cluster <- filter(pca_kmeans, Cluster == "2")
View(ramified_cluster)
ramified_cluster[, -c(1, 1)]
View(ramified_cluster)
ramified_cluster <- filter(pca_kmeans, Cluster == "2")
ramified_cluster[, -c(1, 2)]
View(ramified_cluster)
ramified_cluster <- ramified_cluster[5:]
ramified_cluster <- ramified_cluster[5,]
View(ramified_cluster)
ramified_cluster[, -c(1, 2)]
#setting working directory
setwd("~") #set working directory
#loading packages
library(dplyr)
library(MicrogliaMorphologyR)
library(factoextra)
library(ppclust)
set.seed(1)
#5-10lines of your own code
#pvalue adjustment method, anova, ttest
#read in the data and know the row data that will be enough FOR NEXT TIME
#what do I need to check, do I need to normalize/remove outliers etc.
#saving the directory for the data
#loading in the two sample datasets
data_1xLPS <- MicrogliaMorphologyR::data_1xLPS_mouse
data_2xLPS <- MicrogliaMorphologyR::data_2xLPS_mouse
#filtering out only the control rows from each dataset
data_1xLPS_control <- filter(data_1xLPS, Treatment == 'PBS')
data_2xLPS_control <- filter(data_2xLPS, Treatment == 'PBS')
#removing the two columns that are extra in the second dataset (for ease of merging later)
data_2xLPS_control_mutated <- data_2xLPS_control[, -c(5, 6)]
#combining the two datasets
combined_control_data <- rbind(data_1xLPS_control, data_2xLPS_control_mutated)
#performing a log transformation on the relevant columns from the dataset
normalized_combined_control_data <-transform_log(combined_control_data, 1, start=7, end=33)
#plotting the dataset to explore PCA values
pcadata_elbow(normalized_combined_control_data, featurestart=7, featureend=33)
#
pca_data <- pcadata(normalized_combined_control_data, featurestart=7, featureend=33,
pc.start=1, pc.end=10)
pca_data_scale <- transform_scale(pca_data, start=1, end=3) # scale pca data as input for k-means clustering
kmeans_input <- pca_data_scale[1:3]
sampling <- kmeans_input[sample(nrow(kmeans_input), 5000),] #sample 5000 random rows for cluster optimization
fviz_nbclust(sampling, kmeans, method = 'wss', nstart=25, iter.max=50) # 4 clusters
fviz_nbclust(sampling, kmeans, method = 'silhouette', nstart=25, iter.max=50) # 4 clusters
# cluster and combine with original data
data_kmeans <- kmeans(kmeans_input, centers=4)
# Here, we are creating a new data frame that contains the first 2 PCs and original dataset, then renaming the data_kmeans$cluster column to simply say "Cluster". You can bind together as many of the PCs as you want. Binding the original, untransformed data is useful if you want to plot the raw values of any individual morphology measures downstream.
pca_kmeans <- cbind(pca_data[1:2], combined_control_data, as.data.frame(data_kmeans$cluster)) %>%
rename(Cluster=`data_kmeans$cluster`)
plot <- clusterplots(pca_kmeans, "PC1", "PC2")
clusterfeatures(pca_kmeans, featurestart=9, featureend=35)
#cluster 1 = hypertrophic (average territory span, high branch thickness as explained by pixel density in hull)
#cluster 2 = ramified (largest territory span and branching complexity)
#cluster 3 = ameboid (lowest territory span, high circularity, smallest branch lengths)
#cluster 4 = rod-like (greatest oblongness, lowest circularity)
cp <- clusterpercentage(pca_kmeans, "Cluster", MouseID, Sex)
cp <- cp %>% mutate(Cluster =
case_when(Cluster=="4" ~ "Rod-like",
Cluster=="3" ~ "Ameboid",
Cluster=="2" ~ "Ramified",
Cluster=="1" ~ "Hypertrophic"))
cp %>% clusterpercentage_boxplots(Sex)
stats.input <- cp
stats.input$MouseID <- factor(stats.input$MouseID)
stats.input$Cluster <- factor(stats.input$Cluster)
stats.input$Treatment <- factor(stats.input$Sex)
stats.testing <- stats_cluster.animal(data = stats.input,
model = "percentage ~ Cluster*Sex + (1|MouseID)",
posthoc1 = "~Sex|Cluster",
posthoc2 = "~Sex|Cluster", adjust = "bonferroni")
ramified_cluster <- filter(pca_kmeans, Cluster == "2")
ramified_cluster[, -c(1, 2)]
View(ramified_cluster)
ramified_cluster <- filter(pca_kmeans, Cluster == "2")
ramified_cluster <- ramified_cluster[, -c(1, 2)]
View(ramified_cluster)
#plotting the dataset to explore PCA values
pcadata_elbow(normalized_ramified_cluster, featurestart=7, featureend=33)
ramified_cluster <- filter(pca_kmeans, Cluster == "2")
ramified_cluster <- ramified_cluster[, -c(1, 2)]
normalized_ramified_cluster <- transform_log(ramified_cluster, 1, start=7, end=33)
#plotting the dataset to explore PCA values
pcadata_elbow(normalized_ramified_cluster, featurestart=7, featureend=33)
pca_data <- pcadata(normalized_ramified_cluster, featurestart=7, featureend=33,
pc.start=1, pc.end=10)
pca_data_scale <- transform_scale(pca_data, start=1, end=4)
pca_data_scale <- transform_scale(pca_data, start=1, end=4)
kmeans_input <- pca_data_scale[1:4]
sampling <- kmeans_input[sample(nrow(kmeans_input), 5000),] #sample 5000 random rows for cluster optimization
fviz_nbclust(sampling, kmeans, method = 'wss', nstart=25, iter.max=50) # 4 clusters
fviz_nbclust(sampling, kmeans, method = 'silhouette', nstart=25, iter.max=50) # 4 clusters
ramified_cluster <- ramified_cluster[, !(names(ramified_cluster) %in% c("Cluster"))]
View(ramified_cluster)
#setting working directory
setwd("~") #set working directory
#loading packages
library(dplyr)
library(MicrogliaMorphologyR)
library(factoextra)
library(ppclust)
set.seed(1)
#5-10lines of your own code
#pvalue adjustment method, anova, ttest
#read in the data and know the row data that will be enough FOR NEXT TIME
#what do I need to check, do I need to normalize/remove outliers etc.
#saving the directory for the data
#loading in the two sample datasets
data_1xLPS <- MicrogliaMorphologyR::data_1xLPS_mouse
data_2xLPS <- MicrogliaMorphologyR::data_2xLPS_mouse
#filtering out only the control rows from each dataset
data_1xLPS_control <- filter(data_1xLPS, Treatment == 'PBS')
data_2xLPS_control <- filter(data_2xLPS, Treatment == 'PBS')
#removing the two columns that are extra in the second dataset (for ease of merging later)
data_2xLPS_control_mutated <- data_2xLPS_control[, -c(5, 6)]
#combining the two datasets
combined_control_data <- rbind(data_1xLPS_control, data_2xLPS_control_mutated)
#performing a log transformation on the relevant columns from the dataset
normalized_combined_control_data <-transform_log(combined_control_data, 1, start=7, end=33)
#plotting the dataset to explore PCA values
pcadata_elbow(normalized_combined_control_data, featurestart=7, featureend=33)
#
pca_data <- pcadata(normalized_combined_control_data, featurestart=7, featureend=33,
pc.start=1, pc.end=10)
pca_data_scale <- transform_scale(pca_data, start=1, end=3) # scale pca data as input for k-means clustering
kmeans_input <- pca_data_scale[1:3]
sampling <- kmeans_input[sample(nrow(kmeans_input), 5000),] #sample 5000 random rows for cluster optimization
fviz_nbclust(sampling, kmeans, method = 'wss', nstart=25, iter.max=50) # 4 clusters
fviz_nbclust(sampling, kmeans, method = 'silhouette', nstart=25, iter.max=50) # 4 clusters
# cluster and combine with original data
data_kmeans <- kmeans(kmeans_input, centers=4)
# Here, we are creating a new data frame that contains the first 2 PCs and original dataset, then renaming the data_kmeans$cluster column to simply say "Cluster". You can bind together as many of the PCs as you want. Binding the original, untransformed data is useful if you want to plot the raw values of any individual morphology measures downstream.
pca_kmeans <- cbind(pca_data[1:2], combined_control_data, as.data.frame(data_kmeans$cluster)) %>%
rename(Cluster=`data_kmeans$cluster`)
plot <- clusterplots(pca_kmeans, "PC1", "PC2")
clusterfeatures(pca_kmeans, featurestart=9, featureend=35)
#cluster 1 = hypertrophic (average territory span, high branch thickness as explained by pixel density in hull)
#cluster 2 = ramified (largest territory span and branching complexity)
#cluster 3 = ameboid (lowest territory span, high circularity, smallest branch lengths)
#cluster 4 = rod-like (greatest oblongness, lowest circularity)
cp <- clusterpercentage(pca_kmeans, "Cluster", MouseID, Sex)
cp <- cp %>% mutate(Cluster =
case_when(Cluster=="4" ~ "Rod-like",
Cluster=="3" ~ "Ameboid",
Cluster=="2" ~ "Ramified",
Cluster=="1" ~ "Hypertrophic"))
cp %>% clusterpercentage_boxplots(Sex)
stats.input <- cp
stats.input$MouseID <- factor(stats.input$MouseID)
stats.input$Cluster <- factor(stats.input$Cluster)
stats.input$Treatment <- factor(stats.input$Sex)
stats.testing <- stats_cluster.animal(data = stats.input,
model = "percentage ~ Cluster*Sex + (1|MouseID)",
posthoc1 = "~Sex|Cluster",
posthoc2 = "~Sex|Cluster", adjust = "bonferroni")
##############################
#Ameboid only
# Extracting the "Ameboid" cluster
ramified_cluster <- filter(pca_kmeans, Cluster == "2")
ramified_cluster <- ramified_cluster[, -c(1, 2)]
ramified_cluster <- ramified_cluster[, !(names(ramified_cluster) %in% c("Cluster"))]
normalized_ramified_cluster <- transform_log(ramified_cluster, 1, start=7, end=33)
#plotting the dataset to explore PCA values
pcadata_elbow(normalized_ramified_cluster, featurestart=7, featureend=33)
pca_data_ramified <- pcadata(normalized_ramified_cluster, featurestart=7, featureend=33,
pc.start=1, pc.end=10)
pca_data_scale_ramified <- transform_scale(pca_data_ramified, start=1, end=4)
kmeans_input_ramified <- pca_data_scale_ramified[1:4]
sampling_ramified <- kmeans_input_ramified[sample(nrow(kmeans_input_ramified), 5000),] #sample 5000 random rows for cluster optimization
fviz_nbclust(sampling_ramified, kmeans, method = 'wss', nstart=25, iter.max=50) # 5 clusters
fviz_nbclust(sampling_ramified, kmeans, method = 'silhouette', nstart=25, iter.max=50) # 5 clusters
# cluster and combine with original data
data_kmeans_ramified <- kmeans(kmeans_input_ramified, centers=5)
# Here, we are creating a new data frame that contains the first 2 PCs and original dataset, then renaming the data_kmeans$cluster column to simply say "Cluster". You can bind together as many of the PCs as you want. Binding the original, untransformed data is useful if you want to plot the raw values of any individual morphology measures downstream.
pca_kmeans_ramified <- cbind(pca_data[1:2], ramified_cluster, as.data.frame(data_kmeans_ramified$cluster)) %>%
rename(Cluster=`data_kmeans_ramified$cluster`)
ramified_cluster <- filter(pca_kmeans, Cluster == "2")
ramified_cluster <- ramified_cluster[, -c(1, 2)]
ramified_cluster <- ramified_cluster[, !(names(ramified_cluster) %in% c("Cluster"))]
normalized_ramified_cluster <- transform_log(ramified_cluster, 1, start=7, end=33)
pcadata_elbow(normalized_ramified_cluster, featurestart=7, featureend=33)
pca_data_ramified <- pcadata(normalized_ramified_cluster, featurestart=7, featureend=33,
pc.start=1, pc.end=10)
pca_data_scale_ramified <- transform_scale(pca_data_ramified, start=1, end=4)
kmeans_input_ramified <- pca_data_scale_ramified[1:4]
sampling_ramified <- kmeans_input_ramified[sample(nrow(kmeans_input_ramified), 5000),] #sample 5000 random rows for cluster optimization
fviz_nbclust(sampling_ramified, kmeans, method = 'wss', nstart=25, iter.max=50) # 5 clusters
fviz_nbclust(sampling_ramified, kmeans, method = 'silhouette', nstart=25, iter.max=50) # 5 clusters
# cluster and combine with original data
data_kmeans_ramified <- kmeans(kmeans_input_ramified, centers=5)
pca_kmeans_ramified <- cbind(pca_data[1:2], ramified_cluster, as.data.frame(data_kmeans_ramified$cluster)) %>%
rename(Cluster=`data_kmeans_ramified$cluster`)
pca_kmeans_ramified <- cbind(pca_data_ramified[1:2], ramified_cluster, as.data.frame(data_kmeans_ramified$cluster)) %>%
rename(Cluster=`data_kmeans_ramified$cluster`)
View(pca_kmeans_ramified)
clusterfeatures(pca_kmeans_ramified, featurestart=7, featureend=33)
clusterfeatures(pca_kmeans_ramified, featurestart=9, featureend=33)
clusterfeatures(pca_kmeans, featurestart=9, featureend=33)
colorbycluster <- pca_kmeans %>%
filter(select(c(Cluster, ID)))
colorbycluster <- pca_kmeans %>% select(c(Cluster, ID))
head(colorbycluster)
fraclac.dir <- "/Users/alexlawson/Desktop/for-presentation/fraclac/20241025110857"
skeleton.dir <- "/Users/alexlawson/Desktop/for-presentation/skeleton-data"
# these steps may be very time-intensive, depending on how many cells you are analyzing (i.e., on the order of 1000s of cells).
fraclac <- fraclac_tidying(fraclac.dir)
skeleton <- skeleton_tidying(skeleton.dir)
data <- merge_data(fraclac, skeleton)
example_data <- merge_data(fraclac, skeleton)
View(example_data)
View(fraclac)
View(skeleton)
fraclac <- fraclac_tidying(fraclac.dir)
skeleton <- skeleton_tidying(skeleton.dir)
example_data <- merge_data(fraclac, skeleton)
View(example_data)
stats.input <- cp
stats.input$MouseID <- factor(stats.input$MouseID)
stats.input$Cluster <- factor(stats.input$Cluster)
stats.input$Treatment <- factor(stats.input$Sex)
stats.testing <- stats_cluster.animal(data = stats.input,
model = "percentage ~ Cluster*Sex + (1|MouseID)",
posthoc1 = "~Sex|Cluster",
posthoc2 = "~Sex|Cluster", adjust = "bonferroni")
cp %>%
ggplot(aes(x=Cluster, y=percentage, group=interaction(Cluster, Sex))) +
geom_boxplot(aes(group=interaction(Cluster, Sex), fill=Sex)) +
scale_fill_manual(values=c("#fde725","#482878")) +
geom_point(position=position_dodge(width=0.8), size=0.75, aes(group=interaction(Cluster,Sex), color=Sex)) +
ggtitle("Homeostatic Conditions") +
labs(fill="Sex") +
theme_bw(base_size=14) +
theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1))
cp %>% # in this example, we filter for our brain region of interest
clusterpercentage_boxplots(Sex)
plot <- clusterplots(pca_kmeans, "PC1", "PC2")
clusterfeatures(pca_kmeans, featurestart=9, featureend=35)
#setting working directory
setwd("~") #set working directory
#loading packages
library(dplyr)
library(MicrogliaMorphologyR)
library(factoextra)
library(ppclust)
set.seed(1)
#5-10lines of your own code
#pvalue adjustment method, anova, ttest
#read in the data and know the row data that will be enough FOR NEXT TIME
#what do I need to check, do I need to normalize/remove outliers etc.
#saving the directory for the data
#loading in the two sample datasets
data_1xLPS <- MicrogliaMorphologyR::data_1xLPS_mouse
data_2xLPS <- MicrogliaMorphologyR::data_2xLPS_mouse
#filtering out only the control rows from each dataset
data_1xLPS_control <- filter(data_1xLPS, Treatment == 'PBS')
data_2xLPS_control <- filter(data_2xLPS, Treatment == 'PBS')
#removing the two columns that are extra in the second dataset (for ease of merging later)
data_2xLPS_control_mutated <- data_2xLPS_control[, -c(5, 6)]
#combining the two datasets
combined_control_data <- rbind(data_1xLPS_control, data_2xLPS_control_mutated)
#performing a log transformation on the relevant columns from the dataset
normalized_combined_control_data <-transform_log(combined_control_data, 1, start=7, end=33)
#plotting the dataset to explore PCA values
pcadata_elbow(normalized_combined_control_data, featurestart=7, featureend=33)
#
pca_data <- pcadata(normalized_combined_control_data, featurestart=7, featureend=33,
pc.start=1, pc.end=10)
pca_data_scale <- transform_scale(pca_data, start=1, end=3) # scale pca data as input for k-means clustering
kmeans_input <- pca_data_scale[1:3]
sampling <- kmeans_input[sample(nrow(kmeans_input), 5000),] #sample 5000 random rows for cluster optimization
fviz_nbclust(sampling, kmeans, method = 'wss', nstart=25, iter.max=50) # 4 clusters
fviz_nbclust(sampling, kmeans, method = 'silhouette', nstart=25, iter.max=50) # 4 clusters
# cluster and combine with original data
data_kmeans <- kmeans(kmeans_input, centers=4)
# Here, we are creating a new data frame that contains the first 2 PCs and original dataset, then renaming the data_kmeans$cluster column to simply say "Cluster". You can bind together as many of the PCs as you want. Binding the original, untransformed data is useful if you want to plot the raw values of any individual morphology measures downstream.
pca_kmeans <- cbind(pca_data[1:2], combined_control_data, as.data.frame(data_kmeans$cluster)) %>%
rename(Cluster=`data_kmeans$cluster`)
clusterfeatures(pca_kmeans, featurestart=9, featureend=33)
plot <- clusterplots(pca_kmeans, "PC1", "PC2")
clusterfeatures(pca_kmeans, featurestart=9, featureend=35)
#cluster 1 = hypertrophic (average territory span, high branch thickness as explained by pixel density in hull)
#cluster 2 = ramified (largest territory span and branching complexity)
#cluster 3 = ameboid (lowest territory span, high circularity, smallest branch lengths)
#cluster 4 = rod-like (greatest oblongness, lowest circularity)
cp <- clusterpercentage(pca_kmeans, "Cluster", MouseID, Sex)
cp <- cp %>% mutate(Cluster =
case_when(Cluster=="4" ~ "Rod-like",
Cluster=="3" ~ "Ameboid",
Cluster=="2" ~ "Ramified",
Cluster=="1" ~ "Hypertrophic"))
cp %>% clusterpercentage_boxplots(Sex)
stats.input <- cp
stats.input$MouseID <- factor(stats.input$MouseID)
stats.input$Cluster <- factor(stats.input$Cluster)
stats.input$Treatment <- factor(stats.input$Sex)
stats.testing <- stats_cluster.animal(data = stats.input,
model = "percentage ~ Cluster*Sex + (1|MouseID)",
posthoc1 = "~Sex|Cluster",
posthoc2 = "~Sex|Cluster", adjust = "bonferroni")
cp %>% # in this example, we filter for our brain region of interest
clusterpercentage_boxplots(Sex)
##############################
#Ameboid only
# Extracting the "Ameboid" cluster
ramified_cluster <- filter(pca_kmeans, Cluster == "2")
ramified_cluster <- ramified_cluster[, -c(1, 2)]
ramified_cluster <- ramified_cluster[, !(names(ramified_cluster) %in% c("Cluster"))]
normalized_ramified_cluster <- transform_log(ramified_cluster, 1, start=7, end=33)
#plotting the dataset to explore PCA values
pcadata_elbow(normalized_ramified_cluster, featurestart=7, featureend=33)
pca_data_ramified <- pcadata(normalized_ramified_cluster, featurestart=7, featureend=33,
pc.start=1, pc.end=10)
pca_data_scale_ramified <- transform_scale(pca_data_ramified, start=1, end=4)
kmeans_input_ramified <- pca_data_scale_ramified[1:4]
sampling_ramified <- kmeans_input_ramified[sample(nrow(kmeans_input_ramified), 5000),] #sample 5000 random rows for cluster optimization
fviz_nbclust(sampling_ramified, kmeans, method = 'wss', nstart=25, iter.max=50) # 5 clusters
fviz_nbclust(sampling_ramified, kmeans, method = 'silhouette', nstart=25, iter.max=50) # 5 clusters
# cluster and combine with original data
data_kmeans_ramified <- kmeans(kmeans_input_ramified, centers=5)
# Here, we are creating a new data frame that contains the first 2 PCs and original dataset, then renaming the data_kmeans$cluster column to simply say "Cluster". You can bind together as many of the PCs as you want. Binding the original, untransformed data is useful if you want to plot the raw values of any individual morphology measures downstream.
pca_kmeans_ramified <- cbind(pca_data_ramified[1:2], ramified_cluster, as.data.frame(data_kmeans_ramified$cluster)) %>%
rename(Cluster=`data_kmeans_ramified$cluster`)
clusterfeatures(pca_kmeans_ramified, featurestart=9, featureend=33)
# Selecting relevant columns: total area, branch area, and number of branches (update column names if needed)
ameboid_data <- ameboid_cluster %>%
select(MouseID, Sex, TotalArea = "Area", BranchArea = "Average branch length", NumBranches = "# of branches")
# Summary statistics by Sex for visual inspection
summary(ameboid_data)
# Performing ANOVA to assess differences between sexes for each feature
# Total Area
total_area_anova <- aov(TotalArea ~ Sex, data = ameboid_data)
summary(total_area_anova)
# Branch Area
branch_area_anova <- aov(BranchArea ~ Sex, data = ameboid_data)
summary(branch_area_anova)
# Number of Branches
num_branches_anova <- aov(NumBranches ~ Sex, data = ameboid_data)
summary(num_branches_anova)
# Post-hoc tests (if ANOVA shows significance)
if (summary(total_area_anova)[[1]][["Pr(>F)"]][1] < 0.05) {
posthoc_total_area <- TukeyHSD(total_area_anova)
print(posthoc_total_area)
}
if (summary(branch_area_anova)[[1]][["Pr(>F)"]][1] < 0.05) {
posthoc_branch_area <- TukeyHSD(branch_area_anova)
print(posthoc_branch_area)
}
if (summary(num_branches_anova)[[1]][["Pr(>F)"]][1] < 0.05) {
posthoc_num_branches <- TukeyHSD(num_branches_anova)
print(posthoc_num_branches)
}
#Ramified only
# Extracting the "Ramified" cluster
ramified_cluster <- filter(pca_kmeans, Cluster == "2")
# Selecting relevant columns: total area, branch area, and number of branches (update column names if needed)
ramified_data <- ramified_cluster %>%
select(Sex, TotalArea = "Area", BranchArea = "Average branch length", NumBranches = "# of branches")
# Summary statistics by Sex for visual inspection
summary(ramified_data)
# Performing ANOVA to assess differences between sexes for each feature
# Total Area
total_area_anova_ramified <- aov(TotalArea ~ Sex, data = ramified_data)
summary(total_area_anova_ramified)
View(total_area_anova_ramified)
# Branch Area
branch_area_anova_ramified <- aov(BranchArea ~ Sex, data = ramified_data)
summary(branch_area_anova_ramified)
# Number of Branches
num_branches_anova_ramified <- aov(NumBranches ~ Sex, data = ramified_data)
summary(num_branches_anova_ramified)
# Post-hoc tests (if ANOVA shows significance)
if (summary(total_area_anova_ramified)[[1]][["Pr(>F)"]][1] < 0.05) {
posthoc_total_area_ramified <- TukeyHSD(total_area_anova_ramified)
print(posthoc_total_area_ramified)
}
if (summary(branch_area_anova_ramified)[[1]][["Pr(>F)"]][1] < 0.05) {
posthoc_branch_area_ramified <- TukeyHSD(branch_area_anova_ramified)
print(posthoc_branch_area_ramified)
}
if (summary(num_branches_anova_ramified)[[1]][["Pr(>F)"]][1] < 0.05) {
posthoc_num_branches_ramified <- TukeyHSD(num_branches_anova_ramified)
print(posthoc_num_branches_ramified)
}
#prep the code that we are going to present
#one ttest or anova (review that!), which is the independent and which is the dependent variable
#for loop!!
sampling <- kmeans_input[sample(nrow(kmeans_input), 5000),] #sample 5000 random rows for cluster optimization
fviz_nbclust(sampling, kmeans, method = 'wss', nstart=25, iter.max=50) # 4 clusters
fviz_nbclust(sampling, kmeans, method = 'silhouette', nstart=25, iter.max=50) # 4 clusters
fviz_nbclust(sampling, kmeans, method = 'gap', nstart=25, iter.max=50)
fviz_nbclust(sampling, kmeans, method = 'silhouette', nstart=25, iter.max=50) # 4 clusters
fviz_nbclust(sampling, kmeans, method = 'silhouette', nstart=25, iter.max=50) # 4 clusters
data_kmeans <- kmeans(kmeans_input, centers=4)
sampling <- kmeans_input[sample(nrow(kmeans_input), 5000),] #sample 5000 random rows for cluster optimization
fviz_nbclust(kmeans_input, kmeans, method = 'silhouette', nstart=25, iter.max=50) # 4 clusters
fviz_nbclust(sampling, kmeans, method = 'silhouette', nstart=25, iter.max=50) # 4 clusters
#plotting the dataset to explore PCA values
pcadata_elbow(normalized_combined_control_data, featurestart=7, featureend=33)
fviz_nbclust(sampling, kmeans, method = 'silhouette', nstart=25, iter.max=50) # 4 clusters
clusterfeatures(pca_kmeans, featurestart=9, featureend=33)
?kmeans
stats.testing <- stats_cluster.animal(data = stats.input,
model = "percentage ~ Cluster*Sex",
posthoc1 = "~Sex|Cluster",
posthoc2 = "~Sex|Cluster", adjust = "bonferroni")
View(stats.testing)
stats.input <- cp
stats.testing <- stats_cluster.animal(data = stats.input,
model = "percentage ~ Cluster*Sex",
posthoc1 = "~Sex|Cluster",
posthoc2 = "~Sex|Cluster", adjust = "bonferroni")
View(stats.input)
cp %>% clusterpercentage_boxplots(Sex)
cp <- clusterpercentage(pca_kmeans, "Cluster", Sex)
cp <- cp %>% mutate(Cluster =
case_when(Cluster=="4" ~ "Rod-like",
Cluster=="3" ~ "Ameboid",
Cluster=="2" ~ "Ramified",
Cluster=="1" ~ "Hypertrophic"))
cp %>% clusterpercentage_boxplots(Sex)
cp <- clusterpercentage(pca_kmeans, "Cluster", MouseID, Sex)
cp <- cp %>% mutate(Cluster =
case_when(Cluster=="4" ~ "Rod-like",
Cluster=="3" ~ "Ameboid",
Cluster=="2" ~ "Ramified",
Cluster=="1" ~ "Hypertrophic"))
cp %>% clusterpercentage_boxplots(Sex)
?clusterpercentage
cp <- clusterpercentage(pca_kmeans, "Cluster", Sex)
View(cp)
cp <- cp %>% mutate(Cluster =
case_when(Cluster=="4" ~ "Rod-like",
Cluster=="3" ~ "Ameboid",
Cluster=="2" ~ "Ramified",
Cluster=="1" ~ "Hypertrophic"))
View(cp)
stats.testing <- stats_cluster.animal(data = stats.input,
model = "percentage ~ Cluster*Sex",
posthoc1 = "~Sex|Cluster",
posthoc2 = "~Sex|Cluster", adjust = "bonferroni")
cp %>% clusterpercentage_boxplots(Sex)
ggplot(cp, aes(x = Cluster, y = percentage, fill = gender)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Percentages by Gender",
x = "Cluster",
y = "Percentage (%)") +
scale_fill_manual(values = c("Female" = "purple", "Male" = "blue")) +
theme_minimal()
ggplot(cp, aes(x = Cluster, y = percentage, fill = gender)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Percentages by Gender",
x = "Cluster",
y = "Percentage (%)") +
scale_fill_manual(values = c("Female" = "purple", "Male" = "blue")) +
theme_minimal()
ggplot(cp, aes(x = Cluster, y = percentage, fill = Sex)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Percentages by Gender",
x = "Cluster",
y = "Percentage (%)") +
scale_fill_manual(values = c("Female" = "purple", "Male" = "blue")) +
theme_minimal()
ggplot(cp, aes(x = Cluster, y = percentage, fill = Sex)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Percentages by Gender",
x = "Cluster",
y = "Percentage (%)") +
scale_fill_manual(values = c("F" = "purple", "M" = "blue")) +
theme_minimal()
ggplot(cp, aes(x = Cluster, y = percentage, fill = Sex)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Percentages by Gender",
x = "Cluster",
y = "Percentage (%)") +
scale_fill_manual(values = c("F" = "purple", "M" = "blue"))
ggplot(cp, aes(x = Cluster, y = percentage, fill = Sex)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Comparison of Percentages by Gender",
x = "Cluster",
y = "Percentage (%)") +
scale_fill_manual(values = c("F" = "black", "M" = "white"))
source("~/Documents/GitHub/MicrogliaMorphologyAnalysis/homeostatic-analysis.R")
source("~/Documents/GitHub/MicrogliaMorphologyAnalysis/homeostatic-analysis.R")
setwd("~/Documents/GitHub/MicrogliaMorphologyAnalysis")
#setting working directory
setwd("/Users/alexlawson/Documents/GitHub/MicrogliaMorphologyAnalysis") #set working directory
